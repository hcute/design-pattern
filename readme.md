# 设计模式

## UML 简单入门

### UML 类图和时序图介绍

- 类图的定义

  - 统一建模语言 unified modeling language
  - 非专利的第三代建模和规约语言

- 类图的特点

  - 开放的方法
  - 用于说明、可视化、构建和编写一个正在开发的面向对象的、软件密集系统的制品的开放方法
  - 一系列最佳工程实践
    - 这些最佳实践在大规模、复杂系统进行建模方面，特别是在软件架构层次已被认证有效

- 类图的分类

  - UML2.2分类
    - 结构式图形：强调的是系统式的建模
      - 静态图：类图、对象图、包图
      - 实现图：组件图、部署图
      - 剖面图
      - 复合结构图
    - 行为式图形：强调系统模型中触发的事件
      - 活动图
      - 状态图
      - 用例图
    - 交互式图形：属于行为式图形的子集合，强调系统模型中资料流程
      - 通信图
      - 交互概述图（UML2.0）
      - 时序图（UML2.0）
      - 时间图（UML2.0）

- 类图

  - Class Diagram：用于表示类、接口、实例等之间相互的静态关系

  - 记忆技巧：

    - 实现和继承

      ![](UML实现和继承.png)

      - UML的箭头方向：从子类指向父类
      - 空心三角箭头表示继承或实现
        - 虚线表示实现
        - 实现表示继承 

    - 箭头表示关联｜依赖

      - 实线关联

        ![](UML关联关系.png) 

        - 类中另外一个类为属性

      - 虚线依赖

         ![](UML依赖关系.png)

        - 类为方法的返回或方法的参数

    - 空心菱形 聚合

      ![](UML聚合关系.png)

      - 代表空器皿里可以放很多东西，聚在一起（箭头所指的类）
      - 整体和局部的关系，有独立的生命周期，是 has a关系，是个弱关系 就是空心

    - 实心菱形 组合

      ![](UML组合关系.png)

      - 代表满器皿中已经有实体结构的存在，生死与共
      - 整体和局部的关系，有相同的生命周期，contains-a关系，强关系 实心

      

      > 常见的数字表示含义
      >
      > 假设有A类和B类，数字标记在A侧
      >
      > 0..1  B类和0或1个A实例相关
      >
      > 0..*   B类和0或多个A实例相关
      >
      > 1..1. B类和1个A实例相关
      >
      > 1      B类和A类只有一个相关
      >
      > 1..*   B类和A类至少有一个实例相关

      

- 时序图

  ​	![](UML时序图.png)

  - Sequence Diagram：是显示对象之间交互的图，这些对象是按照时间排列的
  - 包含元素：
    - 对象 Actor
    - 生命线 Lifeline
    - 控制焦点 Focus of control
    - 消息 message 

  

### UML类图详细说明

![](UML类图详细图.png)

> 第一行：类的说明：抽象类，实体类，接口
>
> 第二行：类的属性 
>
> ​	+ public - private #protected  ～default  横线代表static 
>
> 第三行：类的行为



- 实例

  ![](UML详细实例.png)





## 设计原则

### 开闭原则

- 定义
  - 一个软件实体如类、模块、函数应该对扩展开放，对修改关闭
- 精髓
  - 用抽象构建架构，用实现扩展细节
  - 面向抽象编程
- 优点
  - 提高软件系统的可复用性及可维护性

### 依赖倒置原则

- 定义

  - 高层模块不应该依赖低层模块，二者都应该依赖其抽象

    > 高层模块是指：最底层的模块 

  - 抽象不应该依赖细节，细节应该依赖抽象

  - 针对接口编程，不要针对实现编程

- 精髓

  - 依赖接口编程

- 优点

  - 减少类之间的耦合性、提高系统的稳定性、提高代码可读性和可维护性，可降低修改程序所造成的风险

### 单一职责原则

- 定义
  - 不要存在多于一个导致类变更的原因
  - 一个类/一个接口/一个方法负责一项职责
- 精髓
  - 接口和方法一定遵循，但是类可以考虑
- 优点
  - 降低类的复杂度、提高类的可读性、提高系统的可维护性、降低变更引起的风险

### 接口隔离原则

-  定义
  - 用多个专门的接口，而不使用单一的总接口，客户端不应该依赖它不需要的接口
  - 一个类和一个类的依赖应该建立在最小的接口上
  - 建立单一接口，不要建立庞大臃肿的接口
  - 接口尽量细化，接口中的方法尽量少
  - 必须要遵循适度原则
- 优点
  - 符合高内聚和低耦合的设计思想，使得类有很好的可读性、可扩展性和可维护性

### 迪米特法则（最少知道原则）

- 定义

  - 一个对象应该对其他对象保持最少的了解，又叫最少知道原则
  - 尽量降低类与类之间的耦合

- 精髓

  - 只和朋友交流，不和陌生人说话

    > 朋友
    >
    > ​	出现在成员变量，方法的输入，输出参数重的类成为成员朋友，而出现在方法体内部的类不属于朋友

- 优点

  - 降低类之间的耦合

### 里氏替换原则

- 定义
  - 如果对每一个类型为T1的对象o1，都有类型为T2的对象O2，使得以T1定义的所有程序P在所有对象O1都替换成O2时，程序P的行为没有发生变化，那么类型T2就是类型T1的子类型
  - 子类对象可以替换父类对象，程序的逻辑不变
  - 子类可以扩展父类的功能，但是不能改变父类原有的功能
    - 子类可以实现父类的抽象方法，但是不能覆盖父类的非抽象方法
    - 可以扩展自己的特有方法
    - 子类的方法重载父类的方法时，方法的前置条件（入参）要比父类方法的输入参数更加宽松
    - 子类的方法实现父类的方法（重写/重载或实现抽象方法），方法的后置条件（返回值）要比父类更严格或相等
- 优点
  - 约束继承泛滥，开闭原则的一种体现
  - 加强程序的健壮性，同时变更时也可以做到非常好的兼容性，提高程序的可维护性、扩展性。降低需求变更的引入的风险

### 合成/复用原则（组合/复用原则）

- 定义
  - 尽量使用组合、聚合，而不是继承来达到软件的复用的目的
- 优点
  - 是系统更加灵活，降低类之间的耦合度，一个类的变化对其他类造成影响相对较少



## 设计模式

### 设计模式分类

- 创建型模式
  - 工厂方法模式
  - 抽象工厂方法模式
  - 建造者模式
  - 单例模式
  - 原型模式
- 结构型模式
  - 适配器模式
  - 装饰者模式
  - 代理模式
  - 外观模式
  - 桥接模式
  - 组合模式
  - 享元模式
- 行为型模式
  - 策略模式
  - 观察者模式
  - 责任链模式
  - 备忘录模式
  - 模版方法模式
  - 迭代器模式
  - 中介者模式
  - 命令模式
  - 访问者模式
  - 解释器模式
  - 状态模式



### 设计模式详细

#### 简单工厂模式

- 定义
  - 有一个工厂对象决定创建出哪一种产品的实例
  - 类型：创建型，但是不属于GOF23中设计模式
- 使用场景
  - 工厂类创建的对象比较少
  - 客户端（应用层）只知道传入工厂类的参数，对于如何创建对象的逻辑不关心
- 优点
  - 只需要传入一个正确的参数，就可以获取你所属需要的对象，而无需知道其创建细节
- 缺点
  - 工厂类的职责相对过大，增加新的产品需要修改工厂类的判断逻辑，违背了开闭原则